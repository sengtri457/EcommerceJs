// import dataSmall from "./data";
// const dataSmall2 = [...dataSmall];
// console.log(dataSmall2);
const dataSmall2 = [
  {
    id: 24,
    subId: 40,
    name: "Crop Jacket",
    img: "../pic/submenn8.avif",
    class: "img1",
    categoies: "Khmer New Year Sale6",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 25,
    // subId: 13,
    name: "img1",
    img: "../pic/submenn8-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale6",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 26,
    // subId: 13,
    name: "img1",
    img: "../pic/submen8-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale6",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 27,
    // subId: 13,
    name: "img1",
    img: "../pic/submenn8-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale6",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 36,
    subId: 13,
    name: "Crop Hoodiess",
    img: "../pic/submenn9.avif",
    class: "img1",
    categoies: "Khmer New Year Sale7",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 37,
    // subId: 13,
    name: "img1",
    img: "../pic/submenn9-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale7",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 38,
    // subId: 13,
    name: "img1",
    img: "../pic/submenn9-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale7",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 39,
    // subId: 13,
    name: "img1",
    img: "../pic/submen9-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale7",
    usPrice: "$30.99",
    usPriceoff: "$40.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied CropTop",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 64,
    subId: 22,
    name: "Crop Polo",
    img: "../pic/subpolomen1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale13",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Polo",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 65,
    // subId: 40,
    name: "img1",
    img: "../pic/subpolomen2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale13",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied T-Shirt",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 66,
    // subId: 40,
    name: "img1",
    img: "../pic/subpolomen3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale13",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied T-Shirt",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 67,
    // subId: 40,
    name: "img1",
    img: "../pic/subpolormen4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale13",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied T-Shirt",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 68,
    subId: 22,
    name: "Color Polo",
    img: "../pic/subpolomen2-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale14",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied Polo",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 69,
    // subId: 40,
    name: "img1",
    img: "../pic/subpolomen2-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale14",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied T-Shirt",
    MaxQuantity: 50,
    similar: "top",
  },

  {
    id: 70,
    // subId: 40,
    name: "img1",
    img: "../pic/subpolomen2-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale14",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied T-Shirt",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 71,
    // subId: 40,
    name: "img1",
    img: "../pic/subpolomen2-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale14",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied T-Shirt",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 72,
    subId: 22,
    name: "White Polo",
    img: "../pic/subpolomen3-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale15",
    usPrice: "$10.99",
    usPriceoff: "$20.95",
    Priceoff: "-40%",
    typeOfShirt: "Oversied Polo",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    id: 92,
    name: "Nike Club",
    img: "../pic/s5.avif",
    class: "img1",
    categoies: "Khmer New Year Sale92",
    usPrice: "$60.99",
    usPriceoff: "$100.95",
    Priceoff: "-40%",
    typeOfShirt: "short",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subs-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale92",
  },
  {
    name: "img1",
    img: "../pic/subs5-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale92",
  },
  {
    name: "img1",
    img: "../pic/subbs5-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale92",
  },
  {
    name: "img1",
    img: "../pic/subs5-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale92",
  },
  {
    id: 93,
    name: "Nike Club",
    img: "../pic/s6.avif",
    class: "img1",
    categoies: "Khmer New Year Sale93",
    usPrice: "$60.99",
    usPriceoff: "$100.95",
    Priceoff: "-40%",
    typeOfShirt: "short",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subs6-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale93",
  },
  {
    name: "img1",
    img: "../pic/subs6-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale93",
  },
  {
    name: "img1",
    img: "../pic/subs6-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale93",
  },
  {
    name: "img1",
    img: "../pic/subs6-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale93",
  },
  {
    id: 94,
    name: "Nike 24.7 PerfectStretch",
    img: "../pic/s7.avif",
    class: "img1",
    categoies: "Khmer New Year Sale94",
    usPrice: "$95.99",
    usPriceoff: "$100.95",
    Priceoff: "-5%",
    typeOfShirt: "short",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/s8.avif",
    class: "img1",
    categoies: "Khmer New Year Sale94",
  },
  {
    name: "img1",
    img: "../pic/subbs7-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale94",
  },
  {
    name: "img1",
    img: "../pic/subbs7-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale94",
  },
  {
    name: "img1",
    img: "../pic/subs7-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale94",
  },
  {
    id: 95,
    name: "Nike 24.7 Club",
    img: "../pic/s9.avif",
    class: "img1",
    categoies: "Khmer New Year Sale95",
    usPrice: "$55.99",
    usPriceoff: "$100.95",
    Priceoff: "-45%",
    typeOfShirt: "short",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subs9-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale95",
  },
  {
    name: "img1",
    img: "../pic/subs9-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale95",
  },
  {
    name: "img1",
    img: "../pic/subs9-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale95",
  },
  {
    name: "img1",
    img: "../pic/subs9-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale95",
  },
  {
    id: 96,
    name: "Nike 24.7 Club",
    img: "../pic/s10.avif",
    class: "img1",
    categoies: "Khmer New Year Sale96",
    usPrice: "$95.99",
    usPriceoff: "$100.95",
    Priceoff: "-5%",
    typeOfShirt: "short",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subs10-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale96",
  },
  {
    name: "img1",
    img: "../pic/subs10-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale96",
  },
  {
    name: "img1",
    img: "../pic/subs10-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale96",
  },
  {
    name: "img1",
    img: "../pic/subs10-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale96",
  },

  {
    id: 97,
    name: "Nike Life",
    img: "../pic/s11.avif",
    class: "img1",
    categoies: "Khmer New Year Sale97",
    usPrice: "$85.99",
    usPriceoff: "$100.95",
    Priceoff: "-15%",
    typeOfShirt: "short",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subs11-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale97",
  },
  {
    name: "img1",
    img: "../pic/subbs11-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale97",
  },
  {
    name: "img1",
    img: "../pic/subbs11-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale97",
  },
  {
    name: "img1",
    img: "../pic/subs11-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale97",
  },
  {
    id: 119,
    name: "Nike Pro",
    img: "../../pic/len1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale119",
    usPrice: "$40.99",
    usPriceoff: "$50.95",
    Priceoff: "-10%",
    typeOfShirt: "1/2 Length",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/sublen1-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale119",
  },
  {
    name: "img1",
    img: "../pic/sublen1-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale119",
  },
  {
    name: "img1",
    img: "../pic/sublen1-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale119",
  },
  {
    name: "img1",
    img: "../pic/sublen1-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale119",
  },
  {
    id: 120,
    subId: 119,
    name: "Nike life",
    img: "../../pic/len2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale120",
    usPrice: "$20.99",
    usPriceoff: "$40.95",
    Priceoff: "-50%",
    typeOfShirt: "1/2 Length",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subllen2-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale120",
  },
  {
    name: "img1",
    img: "../pic/sublen2-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale120",
  },
  {
    name: "img1",
    img: "../pic/sublen2-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale120",
  },
  {
    name: "img1",
    img: "../pic/sublen2-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale120",
  },
  {
    id: 121,
    subId: 120,
    name: "Nike Primary",
    img: "../../pic/len3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale121",
    usPrice: "$10.99",
    usPriceoff: "$50.95",
    Priceoff: "-90%",
    typeOfShirt: "1/2 Length",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/sublen3-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale121",
  },
  {
    name: "img1",
    img: "../pic/sublen3-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale121",
  },
  {
    name: "img1",
    img: "../pic/sublen3-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale121",
  },
  {
    name: "img1",
    img: "../pic/sublen3-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale121",
  },
  {
    id: 122,
    subId: 120,
    name: "Nike Pro",
    img: "../../pic/len3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale122",
    usPrice: "$20.99",
    usPriceoff: "$40.95",
    Priceoff: "-50%",
    typeOfShirt: "1/2 Length",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/sublen3-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale122",
  },
  {
    name: "img1",
    img: "../pic/sublen3-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale122",
  },
  {
    name: "img1",
    img: "../pic/sublen3-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale122",
  },
  {
    name: "img1",
    img: "../pic/sublen3-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale122",
  },
  {
    id: 123,
    subId: 120,
    name: "Nike Lava",
    img: "../../pic/len2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale123",
    usPrice: "$30.99",
    usPriceoff: "$50.95",
    Priceoff: "-20%",
    typeOfShirt: "1/2 Length",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subllen2-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale123",
  },
  {
    name: "img1",
    img: "../pic/sublen2-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale123",
  },
  {
    name: "img1",
    img: "../pic/sublen2-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale123",
  },
  {
    name: "img1",
    img: "../pic/sublen2-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale123",
  },
  {
    id: 124,
    subId: 120,
    name: "Nike Life",
    img: "../../pic/len1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale124",
    usPrice: "$40.99",
    usPriceoff: "$50.95",
    Priceoff: "-10%",
    typeOfShirt: "1/2 Length",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/sublen1-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale124",
  },
  {
    name: "img1",
    img: "../pic/sublen1-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale124",
  },
  {
    name: "img1",
    img: "../pic/sublen1-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale124",
  },
  {
    name: "img1",
    img: "../pic/sublen1-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale124",
  },
  // mid
  {
    id: 125,
    subId: 127,
    name: "Nike Project",
    img: "../../pic/mid1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale125",
    usPrice: "$80.99",
    usPriceoff: "$100.95",
    Priceoff: "-20%",
    typeOfShirt: "Mid-Thigh",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/submid1-1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale125",
  },
  ,
  {
    name: "img1",
    img: "../pic/submid1-2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale125",
  },
  ,
  {
    name: "img1",
    img: "../pic/submid1-3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale125",
  },
  ,
  {
    name: "img1",
    img: "../pic/submid1-4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale125",
  },
  {
    name: "img1",
    img: "../pic/subleg1.avif",
    class: "img1",
    categoies: "Khmer New Year Sale26",
    usPrice: "$30.99",
    usPriceoff: "$50.95",
    Priceoff: "-40%",
    typeOfShirt: "Legging",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subleg2.avif",
    class: "img1",
    categoies: "Khmer New Year Sale26",
    usPrice: "$30.99",
    usPriceoff: "$50.95",
    Priceoff: "-40%",
    typeOfShirt: "Legging",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subleg3.avif",
    class: "img1",
    categoies: "Khmer New Year Sale26",
    usPrice: "$30.99",
    usPriceoff: "$50.95",
    Priceoff: "-40%",
    typeOfShirt: "Legging",
    MaxQuantity: 50,
    similar: "top",
  },
  {
    name: "img1",
    img: "../pic/subleg4.avif",
    class: "img1",
    categoies: "Khmer New Year Sale26",
    usPrice: "$30.99",
    usPriceoff: "$50.95",
    Priceoff: "-40%",
    typeOfShirt: "Legging",
    MaxQuantity: 50,
    similar: "top",
  },
];

let imageList = [];
let currentIndex = 0;
let currentImages = [];
const params = new URLSearchParams(window.location.search);
const id = parseInt(params.get("id"));
const product = dataSmall2.find((p) => p.id === id);
// Update the main image
function updateMainImage(index) {
  const mainImage = document.getElementById("mainImage");
  const thumbnails = document.querySelectorAll(".thumbnails img");

  thumbnails.forEach((img) => img.classList.remove("active"));
  if (thumbnails[index]) thumbnails[index].classList.add("active");
  // Slide out current image
  mainImage.classList.remove("show");
  mainImage.classList.add("slide-out-left");

  setTimeout(() => {
    mainImage.src = currentImages[index];

    // Slide in new image
    mainImage.onload = () => {
      mainImage.classList.remove("slide-out-left");
      mainImage.classList.add("slide-in-right");

      setTimeout(() => {
        mainImage.classList.remove("slide-in-right");
        mainImage.classList.add("show");
      }, 50); // Small delay to trigger the transition
    };
  }, 300);
}
function selectImage(index) {
  currentIndex = index;
  updateMainImage(index);
}
function nextImage() {
  currentIndex = (currentIndex + 1) % currentImages.length;
  updateMainImage(currentIndex);
}
function prevImage() {
  currentIndex =
    (currentIndex - 1 + currentImages.length) % currentImages.length;
  updateMainImage(currentIndex);
}
window.addEventListener("DOMContentLoaded", () => {
  const thumbnailContainer = document.getElementById("thumbnailContainer");
  const mainImage = document.getElementById("mainImage");
  if (!product) {
    document.body.innerHTML =
      '<a href="../index.html" classs"m-auto"><img src="../pic/4044.gif" alt="" class="w-100" style="height: 600px;margin"></a> ';
    return;
  }
  // Use "categoies" since it's what's used in your data â€” but fix in real data!
  const category = product.categoies;
  if (!category) {
    document.body.innerHTML =
      '    <a href="../index.html"><img src="../pic/nott.gif" alt="" class="w-100 h-auto"></a>';
    return;
  }
  // Get all images from products in the same category
  const sameCategoryItems = dataSmall2.filter(
    (item) => item.categoies === category
  );
  imageList = sameCategoryItems.map((item) => item.img);
  // Remove duplicates
  imageList = [...new Set(imageList)];
  currentImages = imageList;
  currentIndex = currentImages.indexOf(product.img);
  if (currentIndex === -1) currentIndex = 0;

  mainImage.src = currentImages[currentIndex];

  // Create thumbnails
  thumbnailContainer.innerHTML = "";
  currentImages.forEach((imgSrc, index) => {
    const img = document.createElement("img");
    img.src = imgSrc;
    img.alt = `Thumbnail ${index + 1}`;
    img.classList.add("thumbnail");
    if (index === currentIndex) img.classList.add("active");

    img.addEventListener("click", () => selectImage(index));
    thumbnailContainer.appendChild(img);
  });
});

// size

const sizexs = document.querySelector(".size-Xs");
const sizes = document.querySelector(".size-S");
const sizeM = document.querySelector(".size-M");
const sizeL = document.querySelector(".size-L");

sizexs.addEventListener("click", () => {
  sizexs.classList.toggle("sizeSelected");
  sizexs.innerHTML = "XS";
  sizes.classList.remove("sizeSelected");
  sizeM.classList.remove("sizeSelected");
  sizeL.classList.remove("sizeSelected");
});
sizes.addEventListener("click", () => {
  sizes.classList.toggle("sizeSelected");
  sizes.innerHTML = "S";
  sizexs.classList.remove("sizeSelected");
  sizeM.classList.remove("sizeSelected");
  sizeL.classList.remove("sizeSelected");
});
sizeM.addEventListener("click", () => {
  sizeM.innerHTML = "M";
  sizeM.classList.toggle("sizeSelected");
  sizexs.classList.remove("sizeSelected");
  sizes.classList.remove("sizeSelected");
  sizeL.classList.remove("sizeSelected");
});
sizeL.addEventListener("click", () => {
  sizeL.classList.toggle("sizeSelected");
  sizeL.innerHTML = "L";
  sizexs.classList.remove("sizeSelected");
  sizes.classList.remove("sizeSelected");
  sizeM.classList.remove("sizeSelected");
  console.log(sizeL.textContent);
});

const increment = document.querySelector(".increment");
const decrement = document.querySelector(".decrement");
const resultQTY = document.querySelector(".resultQTY");
const btnSub = document.querySelector(".btn-sub");
const result = document.querySelector(".result");
const wrapperitems = document.querySelector(".wrapper-items");
const sizeitem = document.querySelector(".sizeitem");
const qtryitem = document.querySelector(".qtyitem");

resultQTY.innerHTML = 0;
result.innerHTML = 0;
// sizeitem.innerHTML = "";
increment.addEventListener("click", function () {
  if (resultQTY.innerHTML >= product.MaxQuantity) {
    alert("Please input Low qty");
    return;
  }
  resultQTY.innerHTML = parseInt(resultQTY.innerHTML) + 1;
});
decrement.addEventListener("click", function () {
  if (resultQTY.innerHTML <= 0) {
    resultQTY.innerHTML = 0;
  } else {
    resultQTY.innerHTML = parseInt(resultQTY.innerHTML) - 1;
  }
});

const nameP = document.querySelector(".nameP");
const udprice = document.querySelector(".usPrice");
const offPrice = document.querySelector(".offPrice");
const usPriceoff = document.querySelector(".usPriceoff");
const typeOfShirt = document.querySelector(".typeOfShirt");
const udpricevart = document.querySelector(".usPricecart");
const offPricecart = document.querySelector(".offPricecart");
const usPriceoffcart = document.querySelector(".usPriceoffcart");
const typeOfShirtcart = document.querySelector(".typeOfShirtcart");
const totalPrice = document.querySelector(".totalPrice");
if (udprice || offPrice || usPriceoff) {
  usPriceoff.textContent = product.usPriceoff;
  udprice.textContent = product.usPrice;
  offPrice.textContent = product.Priceoff;
  typeOfShirt.textContent = product.typeOfShirt;
  nameP.textContent = product.name;
}
document.addEventListener("DOMContentLoaded", () => {
  const ordersQty = document.querySelector(".orderqty");
  const wrapperCanvases = document.querySelectorAll(".wrapper-canvas");
  const totalOrdersElements = document.querySelectorAll(".totalOrders");
  const wra = document.querySelectorAll(".wrapper-btn-53");
  const lastPrice = document.querySelectorAll(".lastPrice");
  const quan = document.querySelectorAll(".quan");

  let orders = JSON.parse(localStorage.getItem("orders")) || [];

  // Render orders on page load
  renderOrdersUI();

  // Add to Cart Button
  btnSub.addEventListener("click", () => {
    const quantity = parseInt(resultQTY.innerHTML);
    const selectedSize = document.querySelector(".sizeSelected");

    if (!selectedSize) {
      alert("Please select a size before adding to cart.");
      return;
    }

    if (quantity <= 0) {
      alert("Please choose a quantity greater than 0.");
      return;
    }

    const selectedImageSrc = document.getElementById("mainImage").src;

    const cartItem = {
      id: product.id,
      name: product.name,
      size: selectedSize.textContent,
      quantity: quantity,
      image: selectedImageSrc,
      usPriceoff: product.usPriceoff,
      udprice: product.price,
      offPrice: product.Priceoff,
      typeOfShirt: product.typeOfShirt,
      MaxQty: product.MaxQuantity,
    };
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const existingItem = cart.find(
      (item) => item.id === product.id && item.size === cartItem.size
    );
    if (existingItem) {
      existingItem.quantity += quantity;
    } else {
      cart.push(cartItem);
    }
    localStorage.setItem("cart", JSON.stringify(cart));
    // Update Orders
    const orderItem = { ...cartItem, date: Date.now() };
    orders.push(orderItem);
    localStorage.setItem("orders", JSON.stringify(orders));
    ordersQty.innerHTML = orders.length;
    // Reset UI
    resultQTY.innerHTML = 0;
    selectedSize.classList.remove("sizeSelected");
    // Show alert
    alert(
      `Added to cart: ${cartItem.name} [Size: ${cartItem.size}, Qty: ${cartItem.quantity}]`
    );
    // Re-render UI
    renderOrdersUI();
  });

  // Render all orders to UI
  function renderOrdersUI() {
    orders = JSON.parse(localStorage.getItem("orders")) || [];

    let totalAmount = 0;
    let allOrdersHTML = "";

    if (orders.length === 0) {
      wrapperCanvases.forEach((wrapper) => {
        wrapper.innerHTML = "<p>No items</p>";
        wra.forEach((e) => {
          e.classList.add("active");
        });
      });
    } else {
      orders.forEach((order, index) => {
        const price = parseFloat(order.usPriceoff?.replace("$", "") || 0);
        const total = price * order.quantity;
        totalAmount += total;
        lastPrice.forEach((e) => {
          e.innerHTML = "$" + totalAmount.toFixed(2);
        });
        quan.forEach((e) => {
          e.innerHTML = orders.length;
        });
        const orderHTML = `
         <div class="row mt-4">
        <div class="col-lg-6 col-6">
          <span class="usPricecart">Price: $${price.toFixed(2)}</span>
          <h5 class="offPricecart">Discount: ${order.offPrice}</h5>
          <h5 class="typeOfShirtcart">
            type: ${order.typeOfShirt}
          </h5>
          <h5 class="totalPrice1">Total: $${totalAmount.toFixed(2)}</h5>
          <h5 class="sizeitem1">Size: ${order.size}</h5>
          <h5 class="qtyitem1">Quantity: ${order.quantity}</h5>
<button class="button1" onclick="deleteOrder(${index})">
  <svg viewBox="0 0 448 512" class="svgIcon"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path></svg>
</button>
        </div>
        <div class="col-lg-6 col-6">
          <div class="cart-preview">
            <img class="cart-preview-img w-100" src="${order.image}" />
          </div>
        </div>
        </div>`;

        allOrdersHTML += orderHTML;
      });

      wrapperCanvases.forEach((wrapper) => {
        wrapper.innerHTML = allOrdersHTML;
      });
    }

    totalOrdersElements.forEach((el) => {
      el.textContent = orders.length;
    });
  }
});
// Delete order
function deleteOrder(index) {
  const orders = JSON.parse(localStorage.getItem("orders")) || [];
  orders.splice(index, 1);
  localStorage.setItem("orders", JSON.stringify(orders));
  location.reload(); // or call renderOrdersUI() if you remove reload
}
function renderOrdersUI() {
  const orders = JSON.parse(localStorage.getItem("orders")) || [];
  const wrapperCanvases = document.querySelectorAll(".wrapper-canvas");
  const totalOrdersElements = document.querySelectorAll(".totalOrders");
  const wra = document.querySelectorAll(".wrapper-btn-53");

  totalOrdersElements.forEach((el) => (el.textContent = orders.length));
  if (orders.length === 0) {
    wrapperCanvases.forEach((wrapper) => {
      wrapper.innerHTML = "<p>No items</p>";
      wra.forEach((e) => {
        e.classList.add("active");
      });
    });
    return;
  }

  let totalAmount = 0;
  let html = "";

  orders.forEach((order, index) => {
    const price = parseFloat(order.usPriceoff?.replace("$", "") || 0);
    const total = price * order.quantity;
    totalAmount += total;

    html += `
    <div class="row mt-4">
        <div class="col-lg-6 col-6">
          <span class="usPricecart">Price: $${price.toFixed(2)}</span>
          <h5 class="offPricecart">Discount: ${order.offPrice}</h5>
          <h5 class="typeOfShirtcart">
            type: ${order.typeOfShirt}
          </h5>
          <h5 class="totalPrice1">Total: $${totalAmount.toFixed(2)}</h5>
          <h5 class="sizeitem1">Size: ${order.size}</h5>
          <h5 class="qtyitem1">Quantity: ${order.quantity}</h5>
<button class="button1" onclick="deleteOrder(${index})">
  <svg viewBox="0 0 448 512" class="svgIcon"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path></svg>
</button>
        </div>
        <div class="col-lg-6 col-6">
          <div class="cart-preview">
            <img class="cart-preview-img w-100" src="${order.image}" />
          </div>
        </div>
        </div>`;
  });

  wrapperCanvases.forEach((wrapper) => {
    wrapper.innerHTML = html;
  });
}
document.addEventListener("DOMContentLoaded", () => {
  renderOrdersUI();
});

// similar
const wrappersimilar = document.querySelector(".wrapper-similar");
const productNot = document.querySelector(".productNot");

if (product.id == id) {
  wrappersimilar.innerHTML = dataSmall
    .filter((e) => {
      return e.subId == id;
    })
    .map((a) => {
      return ` 
           <div class="row mt-4">
        <div class="col-lg-6 col-6">
          <span class="usPricecart">Price: $${price.toFixed(2)}</span>
          <h5 class="offPricecart">Discount: ${order.offPrice}</h5>
          <h5 class="typeOfShirtcart">
            type: ${order.typeOfShirt}
          </h5>
          <h5 class="totalPrice1">Total: $${totalAmount.toFixed(2)}</h5>
          <h5 class="sizeitem1">Size: ${order.size}</h5>
          <h5 class="qtyitem1">Quantity: ${order.quantity}</h5>
<button class="button1" onclick="deleteOrder(${index})">
  <svg viewBox="0 0 448 512" class="svgIcon"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"></path></svg>
</button>
        </div>
        <div class="col-lg-6 col-6">
          <div class="cart-preview">
            <img class="cart-preview-img w-100" src="${order.image}" />
          </div>
        </div>
        </div>
          `;
    })
    .join("");

  console.log(wrappersimilar);
}
if (product.subId !== id) {
  console.log(id, product.subId);
} else {
  productNot.innerHTML =
    ' <article class="productNot"><h2 class="fw-bolder h2No" style="color:red">Product Does Not Exists!</h2>  <img src="../pic/no.webp" alt="" style="width: 150px;"> </article>';
  console.log(product.subId, id);
}

// Add after your existing code
console.log(result);
function addToFavorites() {
  const mainImage = document.getElementById("mainImage");
  const selectedSize = document.querySelector(".sizeSelected");

  if (!selectedSize) {
    alert("Please select a size first");
    return;
  }

  const favoriteItem = {
    id: product.id,
    name: product.name,
    img: mainImage.src,
    typeOfShirt: product.typeOfShirt,
    price: product.usPrice,
    priceOff: product.Priceoff,
    usPriceoff: product.usPriceoff,
    size: selectedSize.textContent,
  };

  // Get existing favorites
  let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

  // Check if item already exists
  const existingIndex = favorites.findIndex(
    (item) => item.id === favoriteItem.id && item.size === favoriteItem.size
  );

  if (existingIndex !== -1) {
    // Item exists, remove it
    favorites.splice(existingIndex, 1);
    showToast("Removed from favorites");
    document.querySelector(".btnFav i").classList.remove("fa-solid");
    document.querySelector(".btnFav i").classList.add("fa-regular");
  } else {
    // Add new item
    favorites.push(favoriteItem);
    showToast("Added to favorites");
    document.querySelector(".btnFav i").classList.remove("fa-regular");
    document.querySelector(".btnFav i").classList.add("fa-solid");
  }

  localStorage.setItem("favorites", JSON.stringify(favorites));
}
function showToast(message) {
  const toast = document.createElement("div");
  toast.className = "toast-notification";
  toast.textContent = message;
  document.body.appendChild(toast);

  setTimeout(() => {
    toast.remove();
  }, 2000);
  window.location.href = "./AddFav.html";
}

// Check if item is in favorites on page load
document.addEventListener("DOMContentLoaded", function () {
  const favorites = JSON.parse(localStorage.getItem("favorites")) || [];
  const isInFavorites = favorites.some((item) => item.id === product.id);

  if (isInFavorites) {
    document.querySelector(".btnFav i").classList.remove("fa-regular");
    document.querySelector(".btnFav i").classList.add("fa-solid");
  }
});
// dropdown info
const headers = document.querySelectorAll(".dropdown-header");
headers.forEach((header) => {
  header.addEventListener("click", () => {
    const content = header.querySelector(".wrapper-infoText"); // Get the next .dropdown-content
    const chevron = header.querySelector(".chevron");

    // Toggle active class for content
    content.classList.toggle("active");

    // Toggle icon class
    if (content.classList.contains("active")) {
      chevron.classList.remove("fa-chevron-down");
      chevron.classList.add("fa-chevron-up");
    } else {
      chevron.classList.remove("fa-chevron-up");
      chevron.classList.add("fa-chevron-down");
    }
  });
});
